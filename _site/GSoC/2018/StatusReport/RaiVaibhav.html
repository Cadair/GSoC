<!DOCTYPE html>
<html>
    <head>
        <title>Vaibhav Kumar Rai | Project Report </title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
        <link rel="stylesheet" href="/resources/css/style.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.1/css/materialize.min.css">
        <link rel="stylesheet" href="https://rawgit.com/coala/coalaCSS/master/coala.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.1/js/materialize.min.js"></script>
        <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:300,300i,400,400i,700,700i|Roboto:100,200,300,400,500,600,700,800,900|Ubuntu+Mono|Overpass+Mono|Inconsolata" rel="stylesheet">
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    </head>
    <body class='report'>
        <div class="container">
        <br>
            <div class="row no-margin">
                <div class="col m12">
                    <h4 class="left light">Google Summer of Code 2018 Work Product Submission </h4>
                </div>
                <br>
            </div>
            <br>
            <div class="row no-margin">
                <div class="col m6">
                    <div class="card flex1">
                        <div class="card-content">
                            <h5 class="light no-margin"><a href="https://coala.io">coala</a></h5>
                            <h3 class="light">Vaibhav Kumar Rai</h3>
                            <p><p>I am third year student of B.Tech Computer Science Engineering at Shri Mata Vaishno Devi University, Katra, Jammu and Kashmir. I participated in GSoC and worked with <a href="https://coala.io">coala</a> to create better quality Bears by creating a tool which has the ability to jump directly into Bear code and move through it using a debugger interface such as pdb and make debugging of Bears as easy as writing the Bear. A Debugger also has a ability to investigate the settings passed to the Bear. I also implemented a Profiler Interface which provides abilities to profile Bear code to optimize its performance.</p>
</p>
                        </div>
                    </div>
                </div>
                <div class="col m3">
                    <div class="card flex1">
                        <div class="card-content">
                            <div class="center"><h4 class="light no-margin">Project Title</h4></div>
                            <br>
                            <div class="center"><a href="https://summerofcode.withgoogle.com/projects/#6109762077327360">Debug and Profile Bears</a></div>
                        </div>
                    </div>
                    <div class="card flex1">
                        <div class="card-content">
                            <div class="center"><h4 class="light no-margin">GSoC Blog</h4></div>
                            <br>
                            <div class="center"><a class="blog-link" href="https://raivaibhav.github.io">https://raivaibhav.github.io</a></div>
                        </div>
                    </div>
                </div>
                <div class="col m3">
                    <div class="card flex1">
                        <div class="card-content links-section">
                            
                                <div class="link">
                                
                                    <div class="row no-margin ">
                                        <div class="col m6">GitHub</div>
                                        <div class="col m6"><a href="https://github.com/RaiVaibhav">RaiVaibhav</a></div>
                                    </div>
                                
                                </div>
                                <div class="divider"></div>
                            
                                <div class="link">
                                
                                    <div class="row no-margin ">
                                        <div class="col m6">GitLab</div>
                                        <div class="col m6"><a href="https://gitlab.com/RaiVaibhav">RaiVaibhav</a></div>
                                    </div>
                                
                                </div>
                                <div class="divider"></div>
                            
                                <div class="link">
                                
                                    <div class="row no-margin ">
                                        <div class="col m6">Gitter</div>
                                        <div class="col m6"><a href="https://gitter.im/RaiVaibhav">RaiVaibhav</a></div>
                                    </div>
                                
                                </div>
                                <div class="divider"></div>
                            
                                <div class="link">
                                
                                    <div class="row no-margin ">
                                        <div class="col m6">Openhub</div>
                                        <div class="col m6"><a href="https://www.openhub.net/accounts/RaiVaibhav">RaiVaibhav</a></div>
                                    </div>
                                
                                </div>
                                
                            
                            <br>
                            <div class="row no-margin center">
                                <div class="col m3"><i class="fa fa-envelope-o"></i></div>
                                <div class="col m9"><a href="mailto:raivaibhav08@gmail.com">raivaibhav08@gmail.com</a></div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            <br>
            <div class="row no-margin">
                <div class="col m2">
                    <div class="card flex1">
                        <div class="card-content">
                            <div class="center"><h5 class="light no-margin">Patches Tarball</h5></div>
                            <br>
                            <div class="center"><a href="https://rawgit.com/RaiVaibhav/GSoC-Report/master/project.tar.gz">Download</a></div>
                            <br>
                            <div class="center sha256sum_hash">
                                <strong>SHA-256</strong>:
                                <p id="sha256sum_hash_value">
                                    d61862f8f8be5ec168b07741c09781ef2dcc991e44d87edc05e6d237044052b0
                                </p>
                                <i class="fa fa-clipboard" aria-hidden="true"><span class="hinttext">Copy Hash value</span></i>
                            </div>
                        </div>
                    </div>
                </div>
                
                    
                        <div class="col m2">
                            <div class="card flex1">
                                <div class="card-content">
                                <div class="center"><h5 class="light no-margin">Bonding</h5></div>
                                <br>
                                <div class="center"><a href="https://gitlab.com/coala/GSoC/GSoC-2018/milestones/18">View Milestone</a></div>
                                </div>
                            </div>
                        </div>
                    
                
                    
                        <div class="col m2">
                            <div class="card flex1">
                                <div class="card-content">
                                <div class="center"><h5 class="light no-margin">Phase 1</h5></div>
                                <br>
                                <div class="center"><a href="https://gitlab.com/coala/GSoC/GSoC-2018/milestones/52">View Milestone</a></div>
                                </div>
                            </div>
                        </div>
                    
                
                    
                        <div class="col m2">
                            <div class="card flex1">
                                <div class="card-content">
                                <div class="center"><h5 class="light no-margin">Phase 2</h5></div>
                                <br>
                                <div class="center"><a href="https://gitlab.com/coala/GSoC/GSoC-2018/milestones/53">View Milestone</a></div>
                                </div>
                            </div>
                        </div>
                    
                
                    
                        <div class="col m2">
                            <div class="card flex1">
                                <div class="card-content">
                                <div class="center"><h5 class="light no-margin">Phase 3</h5></div>
                                <br>
                                <div class="center"><a href="https://gitlab.com/coala/GSoC/GSoC-2018/milestones/54">View Milestone</a></div>
                                </div>
                            </div>
                        </div>
                    
                
                <div class="col m2">
                    <div class="card flex1">
                        <div class="card-content">
                        <div class="center"><h5 class="light no-margin">Mentors</h5></div>
                        <br>
                        <div class="center"><p><a href="https://github.com/Makman2">Mischa Kr√ºger</a>, <a href="https://github.com/fneu">Fabian Neuschmidt</a>, <a href="https://github.com/arjunsinghy96">Arjun Singh Yadav</a></p>
</div>
                        </div>
                    </div>
                </div>
            </div>
            <br>
             <div class="row no-margin">
                <div class="col m12">
                    <h5 class="left light">Links to commits and repositories I've worked on:</h5>
                </div>
                <br>
            </div>
            <div class="no-margin">
                <table class="padding-table">
                    <thead class="no-border">
                        <tr class="blue-grey-text text-lighten-2">
                            <td></td>
                            <td>Repository</td>
                            <td>Link to Commit/s</td>
                            <td>Description</td>
                        </tr>
                    </thead>
                    <tbody class="card activity">
                        
                        
                           <tr>
                                <td class="fl">c</td>
                                <td class="">&nbsp;cEPs</td>
                                <td><a href='https://github.com/coala/cEPs/commit/d7de1896ed3e9370a431987a210a82751e211066'>View</a></td>
                                <td><p>cEP-0021.md: Proposed implementation of <code class="highlighter-rouge">Profiling Interface</code>.</p>
</td>
                           </tr>
                        
                        
                        
                           <tr>
                                <td class="fl">c</td>
                                <td class="">&nbsp;coala</td>
                                <td><a href='https://github.com/coala/coala/commit/d6186cd1bc3f4e049acac21c657b5a21c55393de'>View</a></td>
                                <td><p>Removed the <code class="highlighter-rouge">filter_raising_callables</code> function and inline it, to decrease the complexity of code for future modification in Debugger<br />Interface pull request.</p>
</td>
                           </tr>
                        
                        
                        
                           <tr>
                                <td class="fl">c</td>
                                <td class="">&nbsp;coala</td>
                                <td><a href='https://github.com/coala/coala/commit/c1184ca58a9cca30afc144e7ad7a1bf7c5fe5f55'>View</a></td>
                                <td><p>Added Debugger Interface with <code class="highlighter-rouge">--debug-bears</code> argument and debug bears process so that pdb work in single process environment and<br />bear developer can debug specified bear.</p>
</td>
                           </tr>
                        
                        
                        
                           <tr>
                                <td class="fl">c</td>
                                <td class="">&nbsp;coala</td>
                                <td><a href='https://github.com/coala/coala/commit/4cb1a6c5bb85bc42a315d118a2f66123465ab4ed'>View</a></td>
                                <td><p>Debug_Bears.rst: Added Debugger Interface document with demo.</p>
</td>
                           </tr>
                        
                        
                        
                           <tr>
                                <td class="fl">c</td>
                                <td class="">&nbsp;coala</td>
                                <td><a href='https://github.com/coala/coala/commit/89833995c1380b813f30bf2048e3f63d495dd71a'>View</a></td>
                                <td><p>Prevent bear test from failing, replaced httpstat with Google teapot because of SSL certification error.</p>
</td>
                           </tr>
                        
                        
                        
                           <tr>
                                <td class="fl">c</td>
                                <td class="">&nbsp;coala-bears</td>
                                <td><a href='https://github.com/coala/coala-bears/commit/8faa08ef573105a75cf31c57298d6b6ba9201d8e'>View</a></td>
                                <td><p>Debugged PySafetyBear to get the cause of upstream problem and failure of appveyor CI, updated PySafetyBear to support lastest version<br />of safety.</p>
</td>
                           </tr>
                        
                        
                        
                           <tr>
                                <td class="fl">c</td>
                                <td class="">&nbsp;coala</td>
                                <td><a href='https://github.com/coala/coala/commit/e9e7e3770791b6df41b414a01c5a956c2b8b356f'>View</a></td>
                                <td><p>Added Settings inspection toolset through which user can access the settings of a Bear in Debug environment.</p>
</td>
                           </tr>
                        
                        
                        
                           <tr>
                                <td class="fl">c</td>
                                <td class="">&nbsp;coala</td>
                                <td><a href='https://github.com/coala/coala/commit/80f8bc955bf4db2892d52262396d824f3050fb71'>View</a></td>
                                <td><p>Debug_bears.rst: Added Settings inspection toolset document with demo.</p>
</td>
                           </tr>
                        
                        
                        
                           <tr>
                                <td class="fl">c</td>
                                <td class="">&nbsp;coala</td>
                                <td><a href='https://github.com/coala/coala/commit/3cb58246351ecbabd9768151cb6b9fe28c3790fc'>View</a></td>
                                <td><p>Removed <code class="highlighter-rouge">debugger</code> flag from <code class="highlighter-rouge">init</code> of bear Base class because of the API breakage issue for the existing users.</p>
</td>
                           </tr>
                        
                        
                        
                           <tr>
                                <td class="fl">c</td>
                                <td class="">&nbsp;coala-utils</td>
                                <td><a href='https://gitlab.com/coala/coala-utils/commit/ba2e0789d0f1c405af93e313e692087077b45954'>View</a></td>
                                <td><p>Enhance TRUE and FALSE STRINGS in coala-utils <code class="highlighter-rouge">constants</code> so that settings like debugger and profiler can be enable and disable with<br />the value like <code class="highlighter-rouge">ok</code>, <code class="highlighter-rouge">positive</code>, <code class="highlighter-rouge">none</code>, <code class="highlighter-rouge">negative</code> etc.</p>
</td>
                           </tr>
                        
                        
                        
                           <tr>
                                <td class="fl">c</td>
                                <td class="">&nbsp;coala</td>
                                <td><a href='https://github.com/coala/coala/commit/fea6e01bd0b5300b0f46c3528981c1e6558e1867'>View</a></td>
                                <td><p>Added Profiler Interface on coala with <code class="highlighter-rouge">--profile</code> argument to profile execution of bear.</p>
</td>
                           </tr>
                        
                        
                        
                           <tr>
                                <td class="fl">m</td>
                                <td class="">&nbsp;mobans</td>
                                <td><a href='https://gitlab.com/coala/mobans/commit/b2d62db0e7bd8879843879974f2168cc3600bfa2'>View</a></td>
                                <td><p>Add <code class="highlighter-rouge">prof/</code> to <code class="highlighter-rouge">coala.gitignore</code> template. Ignored profiled data directory created by <code class="highlighter-rouge">pytest-profiling</code>.</p>
</td>
                           </tr>
                        
                        
                        
                           <tr>
                                <td class="fl">c</td>
                                <td class="">&nbsp;coala</td>
                                <td><a href='https://github.com/coala/coala/commit/0e075217ea1bc5732d9deac57355431db00ef4ee'>View</a></td>
                                <td><p>Profile_Bears.rst: Add Profiling Interface document with demo.</p>
</td>
                           </tr>
                        
                        
                        
                           <tr>
                                <td class="fl">p</td>
                                <td class="">&nbsp;pytest-plugins</td>
                                <td><a href='https://github.com/manahl/pytest-plugins/pull/89/commits/6f8d598b210da0f76e09ff86811d4538a1bc6c43'>View</a></td>
                                <td><p>pytest_profiling.py: Add additional argument to configurable profile output directory. (Not merged; approved by GSoC admin)</p>
</td>
                           </tr>
                        
                        
                    </tbody>
                </table>
            </div>
            <br>
            <div class="content card">
                <div class="card-content">
                    <h3 id="debug-and-profile-bears">Debug and Profile Bears</h3>

<h4 id="work-done">Work Done</h4>

<ol>
  <li>Debugger Interface added in coala.
    <ol>
      <li>Step into the <code class="highlighter-rouge">run()</code> method of a bear move through it using a debugger
interface such as <code class="highlighter-rouge">pdb</code> and exits as soon as <code class="highlighter-rouge">run()</code> is left.</li>
      <li>Pdb‚Äôs quit-command (<code class="highlighter-rouge">q</code>) remapped so coala continues its normal execution
without aborting. So, <code class="highlighter-rouge">quit</code> or <code class="highlighter-rouge">q</code> will first clear all breakpoints and
then continue execution.</li>
      <li>Users can specify the bear they want to debug using <code class="highlighter-rouge">--debug-bears</code>.</li>
      <li>Users can specify to debug bears using a <code class="highlighter-rouge">.coafile</code>.</li>
    </ol>
  </li>
  <li>
    <p>A new command <code class="highlighter-rouge">settings</code> is included in coala‚Äôs Debugging Interface to
inspect Bear settings in the debugging environment. It displays all passed
settings of a Bear and their values so bear developer can quickly inspect
them.</p>
  </li>
  <li>Profiler Interface added in coala.
    <ol>
      <li>The profiler will start by profiling the <code class="highlighter-rouge">run()</code> method of bears because
this is the part where bear writers will spend time on, as rest of the
part like loading the files, collecting the settings, etc. are done by
coala itself.</li>
      <li><code class="highlighter-rouge">--profile-bears</code> or <code class="highlighter-rouge">profile_bears</code> (using .coafile) is the main argument
to enable profiling.</li>
      <li>Accept an additional parameter <code class="highlighter-rouge">directory_path</code> through which bear
developers can specify where to store the profiled data files.</li>
    </ol>
  </li>
</ol>

<h4 id="challenges">Challenges</h4>

<p>I had difficulties with testing of Debugger interface. With the help of <code class="highlighter-rouge">Mock</code>,
test for debugger interface was created, though code coverage was 100% but
<code class="highlighter-rouge">mock</code> test was not the ideal test, so after hours of discussion with Mischa we
decided to capture the <code class="highlighter-rouge">pdb stdout</code> and assert the the output with the real
output but problem arised, the ideal tests passes but somehow it didn‚Äôt showed
the code coverage to 100% not only that it also removed the coverage of the
previous tests, at first I thought created test have some problem but seems
like <code class="highlighter-rouge">pytest-cov</code> had a problem, so to confirm that I created a
<a href="https://github.com/RaiVaibhav/test_repo">test repo</a> and enable the
<a href="https://travis-ci.org/RaiVaibhav/test_repo">CI</a> on that repo to check the
coverage report, it also showed same failure. So, I created a issue on
<code class="highlighter-rouge">pytest-cov</code> repo but actual problem was, both coverage and debugger use the
same trace feature, so it was not possible to run coverage and debugger in
parallel or say it is not possible to chain the trace functions, so Mischa gave
a idea to restore the trace callbacks and then run test, it worked finally so I
included both ideal and <code class="highlighter-rouge">Mock</code> test so that the coverage remain 100, but in all
of these I lagged around 3 week from my schedule. So I couldn‚Äôt implement one of
the proposed feature.</p>

<h4 id="work-to-be-done">Work to be done</h4>

<p>A tool which will provide the ability to inspect result instances like
<code class="highlighter-rouge">origin</code>, <code class="highlighter-rouge">diffs</code>, <code class="highlighter-rouge">file</code>, <code class="highlighter-rouge">severity</code>, <code class="highlighter-rouge">message</code>, <code class="highlighter-rouge">aspects</code> and several other
attributes in debugging environment or in a seperate python console where all
where user can easily access there values. Information about result will help
bear developer in creating a better performant Bears.</p>

<p>Result inspection tool will not only help in debugging the bear results but
also help in testing the bear by asserting the various attributes of expected
result with actual result.</p>

                </div>
            </div>
            <br><br>
        </div>
        <script>
        $('document').ready(function(){
            var hash_value = document.getElementById('sha256sum_hash_value').textContent.trim();
            document.getElementById('sha256sum_hash_value').textContent = hash_value.substring(0,7);
            document.querySelector('.fa-clipboard').addEventListener('click', function(){
                var new_element = document.createElement('textarea');
                $('new_element:first').addClass('hash_value_dup');
                new_element.value = hash_value;
                new_element.setAttribute('readonly', '');
                document.body.appendChild(new_element);
                new_element.select();
                document.execCommand('copy');
                document.body.removeChild(new_element);
                });
        })
        </script>
    </body>
</html>
